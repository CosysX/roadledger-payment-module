<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [getBalance][1]
    -   [Examples][2]
-   [createServer][3]
    -   [Parameters][4]
    -   [Examples][5]
-   [on][6]
    -   [Parameters][7]
    -   [Examples][8]
-   [createPayment][9]
    -   [Parameters][10]
    -   [Examples][11]
-   [getPayments][12]
    -   [Examples][13]
-   [getOpenPayments][14]
    -   [Examples][15]
-   [getPaidPayments][16]
    -   [Examples][17]
-   [getPaymentByID][18]
    -   [Parameters][19]
    -   [Examples][20]
-   [send][21]
    -   [Parameters][22]
    -   [Examples][23]
-   [getPayouts][24]
    -   [Examples][25]
-   [getOpenpayouts][26]
    -   [Examples][27]
-   [getPayoutByID][28]
    -   [Parameters][29]
    -   [Examples][30]
-   [getPayoutByTxhash][31]
    -   [Parameters][32]
    -   [Examples][33]

## getBalance

Returns the balance

### Examples

```javascript
// get payout by txhash
paymentModule.getBalance()
 .then(balance => {
     console.log(balance)
   })
 .catch(err => {
   console.log(err)
 })
//example balance:
15
```

Returns **[number][34]** balance

## createServer

Creates and returns a express server.

### Parameters

-   `app` **[object][35]** an express application.
-   `options` **[object][35]** an options object. (optional, default `{}`)
    -   `options.websockets` **[Boolean][36]** websockets.
    -   `options.dashboard` **[Boolean][36]** dashboard at /iotapay.
    -   `options.api` **[Boolean][36]** api at /iotapay/api.

### Examples

```javascript
// creates a simple server
var paymentModule = require('iota-payment')
var app = require('express')()

let server = paymentModule.createServer(app, {api: true})

// Start server with iota-payment api on '/iotapay/api'
server.listen(3000, function () {
   console.log(`Server started on http://localhost:3000 `)
})
```

Returns **[object][35]** an http server

## on

This method attaches an event listener.
Possible events:
\-payments: 'paymentCreated', 'paymentPending', 'paymentIncoming', 'paymentSuccess'
\-payouts: 'payoutCreated', 'payoutSent'

### Parameters

-   `event` **[object][35]** event name
-   `fnc` **[function][37]** the function which will be called

### Examples

```javascript
const paymentModule = require('iota-payment')

//Create an event handler which is called, when a payment was successfull
let onPaymentSuccess = function (payment) {
    console.log('payment success!', payment);
}

//Assign the event handler to an event:
paymentModule.on('paymentSuccess', onPaymentSuccess);
```

## createPayment

Creates and returns a payment.

### Parameters

-   `paymentInput` **[object][35]** data for the payment
    -   `paymentInput.value` **[number][34]?** iota value
    -   `paymentInput.timeUntilConfirmation` **[number][34]?** time in seconds until the payment is confirmed, independent of the received amount
    -   `paymentInput.data` **any?** additional data

### Examples

```javascript
// create a payment with the value option
paymentModule.payment.createPayment({value: 1, data: { "test": "123" }})
 .then(payment => {
   console.log(payment)
 })
 .catch(err => {
   console.log(err)
 })
//example payment:
{ data: '',
payed: false,
txInfo: null,
type: 'value',
value: 1,
address:
 'IDEAVKKGLZUCAZJEWOUXVCUYGPSINKJR9UVBEOXRNIOBJFAKUN9GVBDGVEVOOK9HVMMMFMDLZ9G9YFHPWULQWCXYVW',
index: 49,
id: '1575750004195'}
// create a payment with the timeUntilConfirmation option
paymentModule.payment.createPayment({timeUntilConfirmation: 180, data: { "test": "123" }})
 .then(payment => {
   console.log(payment)
 })
 .catch(err => {
   console.log(err)
 })
//example payment:
{ data: { test: '123' },
payed: false,
txInfo: null,
type: 'time',
confirmationTime: 1575750870,
address:
 'BQGQONEUNQYDDEUFDZIJDTVTFUBSIQECBLPU9BNNDVPMXMKFCWYODBGSPHA9TYCFFSYGUH9OIZYDIGBMCXHRBEIIAX',
index: 50,
id: '1575750690816' }
```

Returns **[object][35]** payment

## getPayments

Returns all payments

### Examples

```javascript
// get payments
paymentModule.payment.getPayments()
 .then(payments => {
   console.log(payments)
 })
 .catch(err => {
   console.log(err)
 })
//example payments:
[ { address:
  'CLHNILYEPUQYJWRSGPQGA9BVVKHFHQMDM9ENNSGAHJXJIOLMBARZNHKWZZVGXSSQITOHPD9JXQGVQJJJBKMVRFWSNW',
 index: 10,
 value: '0',
 data: 'test',
 payed: true,
 id: '1570466750915',
 lastTime: 1570466754629 },
{ address:
  'CLTDMWYNTKMPSISD9CBLH9MGATUZQXDALPZQBMHPJQLTKDTWDKFRJQYDKUCPYQFTFPNJBEIHHJRBKQMXXHNSUYEXJC',
 index: 12,
 value: 1,
 payed: false,
 id: '1570564499942' } ]
```

Returns **[Array][38]&lt;[Object][35]>** payments

## getOpenPayments

Returns all open (not payed and not too old) payments

### Examples

```javascript
// get open payments
paymentModule.payment.getPayments()
 .then(payments => {
   console.log(payments)
 })
 .catch(err => {
   console.log(err)
 })
//example payments:
[ { address:
  'QXHAEPJSEIUAMMOUWDGYJD9MPPIGBYOPAQSPOZK9VZSGDVVV9SUJEYVXYRFL9KRRBWSDNIFGBDLH9DBADGABSCFTFD',
 index: 11,
 value: 1,
 data: { test: '123' },
 payed: false,
 id: '1570554460662' },
{ address:
  'CLTDMWYNTKMPSISD9CBLH9MGATUZQXDALPZQBMHPJQLTKDTWDKFRJQYDKUCPYQFTFPNJBEIHHJRBKQMXXHNSUYEXJC',
 index: 12,
 value: 1,
 payed: false,
 id: '1570564499942' } ]
```

Returns **[Array][38]&lt;[Object][35]>** open payments

## getPaidPayments

Returns all paid (not open and not too old) payments

### Examples

```javascript
// get open payments
paymentModule.payment.getPaidPayments()
 .then(payments => {
   console.log(payments)
 })
 .catch(err => {
   console.log(err)
 })
//example payments:
[ { address:
  'QXHAEPJSEIUAMMOUWDGYJD9MPPIGBYOPAQSPOZK9VZSGDVVV9SUJEYVXYRFL9KRRBWSDNIFGBDLH9DBADGABSCFTFD',
 index: 11,
 value: 1,
 data: { test: '123' },
 payed: true,
 id: '1570554460662' },
{ address:
  'CLTDMWYNTKMPSISD9CBLH9MGATUZQXDALPZQBMHPJQLTKDTWDKFRJQYDKUCPYQFTFPNJBEIHHJRBKQMXXHNSUYEXJC',
 index: 12,
 value: 1,
 payed: true,
 id: '1570564499942' } ]
```

Returns **[Array][38]&lt;[Object][35]>** paid payments

## getPaymentByID

Returns payment by id

### Parameters

-   `id`  

### Examples

```javascript
// get payment by id
paymentModule.payment.getPaymentByID('1570564499942')
 .then(payment => {
   console.log(payment)
 })
 .catch(err => {
   console.log(err)
 })
//example payment:
{ address:
  'CLTDMWYNTKMPSISD9CBLH9MGATUZQXDALPZQBMHPJQLTKDTWDKFRJQYDKUCPYQFTFPNJBEIHHJRBKQMXXHNSUYEXJC',
 index: 12,
 value: 1,
 payed: false,
 id: '1570564499942' }
```

Returns **[Object][35]** payment

## send

Creates and returns a payout.

### Parameters

-   `payoutData` **[object][35]** data for the payout
    -   `payoutData.address` **address** 90 trytes iota address (with checksum)
    -   `payoutData.amount` **[number][34]** amount of iotas
    -   `payoutData.message` **[string][39]?** message which will be send with the transaction
    -   `payoutData.tag` **[string][39]?** tryte tag
    -   `payoutData.data` **any?** additional data, is only stored locally
    -   `payoutData.startIndex` **[number][34]?** custom start index to search for inputaddresses
    -   `payoutData.endIndex` **[number][34]?** custom end index to search for inputaddresses

### Examples

```javascript
// create a payout
let payoutObject = {
  //required
  address: 'HW99PKRDWBUCCWLEQDONQXW9AXQHZAABYEKWSEFYAUIQWWCLVHAUJEQAZJACAGPZBZSQJIOUXRYYEXWZCXXOAJMZVY',
  value: 1,
  //optional
  message: 'Example message',
  tag: 'TRYTETAG',
  data: {test: 27},
  //indexes for input addresses, only required in special cases
  // startIndex: 0,
  // endIndex: 1
}
paymentModule.payout.send(payoutObject)
 .then(payout => {
   console.log(payout)
 })
 .catch(err => {
   console.log(err)
 })
//example payout:
{ address:
 'HW99PKRDWBUCCWLEQDONQXW9AXQHZAABYEKWSEFYAUIQWWCLVHAUJEQAZJACAGPZBZSQJIOUXRYYEXWZCXXOAJMZVY',
value: 1,
message: 'Example message',
tag: 'TRYTETAG',
data: {test: 27},
payed: false,
id: '1570619992125' }
```

Returns **[object][35]** payout

## getPayouts

Returns all payouts

### Examples

```javascript
// get payouts
paymentModule.payout.getPayouts()
 .then(payouts => {
   console.log(payouts)
 })
 .catch(err => {
   console.log(err)
 })
//example payouts:
[
 {
   "address": "USKSGFKPWVXD9EUOJXWNLVWG9FDTIPGBUYB9BQNMMUWIEOMFNDCCUKCJMEPRICBHZNRAIZFGNPK9GCGBYQAEWNJRMC",
   "value": 1,
   "message": "Example message",
   "payed": true,
   "id": "1570616325073",
   "txhash": "XKLLL9B9AUN9EASCAQAQHEYDLLEUDDUCOTJVNTJUSZVTNWUTDPHZUFUJAHFZJOSQYYEPJSWRDXDJ99999"
 },
 {
   "address": "HW99PKRDWBUCCWLEQDONQXW9AXQHZAABYEKWSEFYAUIQWWCLVHAUJEQAZJACAGPZBZSQJIOUXRYYEXWZCXXOAJMZVY",
   "value": 1,
   "message": "Example message",
   "payed": false,
   "id": "1570616561382"
 }
]
```

Returns **[Array][38]&lt;[Object][35]>** payouts

## getOpenpayouts

Returns open payouts

### Examples

```javascript
// get open payouts
paymentModule.payout.getOpenpayouts()
 .then(payouts => {
   console.log(payouts)
 })
 .catch(err => {
   console.log(err)
 })
//example payouts:
[
 {
   "address": "HW99PKRDWBUCCWLEQDONQXW9AXQHZAABYEKWSEFYAUIQWWCLVHAUJEQAZJACAGPZBZSQJIOUXRYYEXWZCXXOAJMZVY",
   "value": 1,
   "message": "Example message",
   "payed": false,
   "id": "1570616561382"
 }
]
```

Returns **[Array][38]&lt;[Object][35]>** open payouts

## getPayoutByID

Returns payout by id

### Parameters

-   `id`  

### Examples

```javascript
// get payout by id
paymentModule.payout.getPayoutByID('1570611186704')
 .then(payout => {
   console.log(payout)
 })
 .catch(err => {
   console.log(err)
 })
//example payout:
{ address:
 'USKSGFKPWVXD9EUOJXWNLVWG9FDTIPGBUYB9BQNMMUWIEOMFNDCCUKCJMEPRICBHZNRAIZFGNPK9GCGBYQAEWNJRMC',
value: 1,
message: 'Example message',
payed: false,
id: '1570611186704' }
```

Returns **[Object][35]** payment

## getPayoutByTxhash

Returns payout by txhash

### Parameters

-   `txhash`  

### Examples

```javascript
// get payout by txhash
paymentModule.payout.getPayoutByTxhash('XKLLL9B9AUN9EASCAQAQHEYDLLEUDDUCOTJVNTJUSZVTNWUTDPHZUFUJAHFZJOSQYYEPJSWRDXDJ99999')
 .then(payout => {
  console.log(payout)
 })
 .catch(err => {
    console.log(err)
  })
//example payout:
{ address:
 'USKSGFKPWVXD9EUOJXWNLVWG9FDTIPGBUYB9BQNMMUWIEOMFNDCCUKCJMEPRICBHZNRAIZFGNPK9GCGBYQAEWNJRMC',
value: 1,
message: 'Example message',
payed: true,
id: '1570616325073',
txhash:
 'XKLLL9B9AUN9EASCAQAQHEYDLLEUDDUCOTJVNTJUSZVTNWUTDPHZUFUJAHFZJOSQYYEPJSWRDXDJ99999' }
```

Returns **[Object][35]** payment

## 

WebSockets with socket.io

backend:
[https://github.com/machineeconomy/iota-payment/blob/master/examples/06_websockets.js][40]

frontend:
[https://github.com/machineeconomy/iota-payment/blob/master/examples/06_websocket.html][41]

[1]: #getbalance

[2]: #examples

[3]: #createserver

[4]: #parameters

[5]: #examples-1

[6]: #on

[7]: #parameters-1

[8]: #examples-2

[9]: #createpayment

[10]: #parameters-2

[11]: #examples-3

[12]: #getpayments

[13]: #examples-4

[14]: #getopenpayments

[15]: #examples-5

[16]: #getpaidpayments

[17]: #examples-6

[18]: #getpaymentbyid

[19]: #parameters-3

[20]: #examples-7

[21]: #send

[22]: #parameters-4

[23]: #examples-8

[24]: #getpayouts

[25]: #examples-9

[26]: #getopenpayouts

[27]: #examples-10

[28]: #getpayoutbyid

[29]: #parameters-5

[30]: #examples-11

[31]: #getpayoutbytxhash

[32]: #parameters-6

[33]: #examples-12

[34]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number

[35]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object

[36]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean

[37]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Statements/function

[38]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array

[39]: https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String

[40]: https://github.com/machineeconomy/iota-payment/blob/master/examples/06_websockets.js

[41]: https://github.com/machineeconomy/iota-payment/blob/master/examples/06_websocket.html
